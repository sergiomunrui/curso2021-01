<?xml version="1.0" encoding="utf-8"?>
<odoo>

<!-- Vista tipo Lista-->

        <record id="view_helpdesk_ticket_tree" model="ir.ui.view">
            <field name="name">view.helpdesk_ticket.tree</field>
            <field name="model">helpdesk.ticket</field>
            <field name="arch" type="xml">
                <tree string="Ticket">
                    <field name="name" />
                    <field name="date" />
                    <field name="state" />
                </tree>
            </field>
        </record>

<!-- En la vista formulario:
- poner un header con el status bar
- nombre con h1 como en pedido de venta
- dos columnas:
  - fecha, fecha límite
  - asignado, tiempo dedicado
- solapas:
  - Descripción
  - Calidad
    - Acción correctiva
    - Acción preventiva -->

    <record id="view_helpdesk_ticket_form" model="ir.ui.view">
            <field name="name">view.helpdesk_ticket.form</field>
            <field name="model">helpdesk.ticket</field>
            <field name="arch" type="xml">
                <form string="Ticket">
                    <header>  
                    <!-- - Botones del header: -->
                    <!-- - Asignar, cambia estado a asignado y pone a true el campo asignado, visible sólo con estado = nuevo -->
                    <button name="asignar" type="object" string="Asignar" states="nuevo"/>
                    <!-- - En proceso, visible sólo con estado = asignado -->
                    <button name="proceso" type="object" string="En proceso" states="asignado"/>
                    <!-- - Pendiente, visible sólo con estado = en proceso o asignado -->
                    <button name="pendiente" type="object" string="Pendiente" states="asignado,proceso"/>
                    <!-- - Finalizar, visible en cualquier estado, menos cancelado y finalizado -->
                    <button name="finalizar" type="object" string="Finalizar" states="nuevo,asignado,pendiente,proceso"/>
                    <!-- - Cancelar, visible si no está cancelado -->
                    <button name="cancelar" type="object" string="Cancelar" states="nuevo,asignado,pendiente,proceso,resuelto"/>

                        <field name="state" widget="statusbar" />
                    </header>

                    <sheet>
                        <div class="oe_title">
                            <h1>
                                <field name="name"/>
                            </h1>
                        </div>
                        <group>
                            <group>
                                <field name="date"/>
                                <field name="date_limit"/>
                            </group>
                            <group>
                                <field name="user_id"/>
                                <field name="assigned"/>
                                <field name="time"/>
                                <field name="ticket_cantidad"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="Description">
                                <field name="description"/>
                                <group>
                                    <field name="tag_name"/>
                                    <button string="Crear etiqueta"
                                    name="create_tag"
                                    type="object"/>
                                </group>
                                <field name="tag_ids"/>
                            </page>
                            <page string="Actions">
                                <field name="action_ids"/> 
                            </page>
                            <page string="Quality">
                                <group>
                                    <field name="action_corrective"/> <!--De esta forma se ve la etiqueta a la izq del campo a editar dentro de Quality -->
                                </group>
                                <group string="Preventive Action"> <!--De esta forma se ve la etiqueta arriba del campo a editar dentro de Quality -->
                                    <field name="action_preventive" nolabel="1"/>
                                </group>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>

        <!-- Vista tipo Search-->

        <record id="view_helpdesk_ticket_search" model="ir.ui.view">
            <field name="name">view.helpdesk_ticket.search</field>
            <field name="model">helpdesk.ticket</field>
            <field name="arch" type="xml">
                <search string="Ticket">
                    <!-- Búsquedas-->
                    <field name="name" /> <!-- filtra por nombre -->
                    <field name="user_id" /> <!-- filtra por assigned to -->
                    <field name="date" /> <!-- filtra por fecha si lo introducido está en formato dd-mm-aaa -->
                    <field name="state" /> <!-- filtra por estado -->
                    <field name="description" /> <!-- filtra por descripción-->
                    <!-- Búsquedas con filtros con dominio aplicado-->
                    <filter string='Asignado' name='assigned_to' domain="[('user_id', '!=', False)]"/>
                    <filter string='Date limit' name='date_limit' domain="[('date_limit', '!=', False)]"/>
                    <filter string='No date limit' name='date_limit' domain="[('date_limit', '=', False)]"/>
                    <!-- Agrupado por-->
                    <filter string="Asignado a" name="assigned_to" context="{'group_by':'user_id'}"/>
                    <filter string="Fecha límite" name="fecha limite" context="{'group_by':'date_limit'}"/>
                </search>
            </field>
        </record>


        <!-- Vista pivot-->
        <record id="view_helpdesk_ticket_pivot" model="ir.ui.view">
            <field name="name">view.helpdesk_ticket.pivot</field>
            <field name="model">helpdesk.ticket</field>
            <field name="arch" type="xml">
                <pivot string="Ticket">
                    <field name="user_id" type="row"/>
                    <field name="date" interval="month" type="col"/>
                    <field name="time" type="measure" widget="float_time"/>
                </pivot>
            </field>
        </record>

        <!--Vista graph-->

        <record id="view_helpdesk_ticket_graph" model="ir.ui.view">
            <field name="name">view.helpdesk_ticket.graph</field>
            <field name="model">helpdesk.ticket</field>
            <field name="arch" type="xml">
                <graph string="Ticket">
                    <field name="user_id"/>
                    <field name="time" type="measure" widget="float_time"/>
                </graph>
            </field>
        </record>


        <!--Vista calendar-->
        <record id="view_helpdesk_ticket_calendar" model="ir.ui.view">
            <field name="name">view.helpdesk_ticket.calendar</field>
            <field name="model">helpdesk.ticket</field>
            <field name="arch" type="xml">
                <calendar string="Tickets" date_start="date" color="user_id" hide_time="true" event_limit="5">
                    <field name="user_id" avatar_field="image_128"/>
                    <field name="name"/>
                    <field name="user_id" filters="1" invisible="1"/>
                </calendar>
            </field>
        </record>

        <!--Vista kanban-->
        <record id="view_helpdesk_ticket_kanban" model="ir.ui.view">
            <field name="name">view.helpdesk_ticket.kanban</field>
            <field name="model">helpdesk.ticket</field>
            <field name="arch" type="xml">
                <kanban default_group_by="user_id">
                    <templates>
                        <t t-name="kanban-box"> 
                            <div t-attf-class="oe_kanban_content oe_kanban_global_click">
                                Name: <field name="name"/>
                                <br/>
                                <div class="o_kanban_record_subtitle">
                                    <field name="date" />
                                    <field name="time" />                                
                                </div>
                                <div class="o_kanban_record_bottom">
                                    <div class="oe_kanban_bottom_right">
                                        <field name="user_id" widget="many2one_avatar_user"/>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>


</odoo>